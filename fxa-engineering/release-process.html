<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Firefox Ecosystem Platform" href="/ecosystem-platform/opensearch.xml"><title data-react-helmet="true">Release Process | Firefox Ecosystem Platform</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://mozilla.github.io/ecosystem-platform/fxa-engineering/release-process"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Release Process | Firefox Ecosystem Platform"><meta data-react-helmet="true" name="description" content="Release Owner"><meta data-react-helmet="true" property="og:description" content="Release Owner"><link data-react-helmet="true" rel="shortcut icon" href="/ecosystem-platform/img/firefox-logo.png"><link data-react-helmet="true" rel="canonical" href="https://mozilla.github.io/ecosystem-platform/fxa-engineering/release-process"><link data-react-helmet="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/fxa-engineering/release-process" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/fxa-engineering/release-process" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/ecosystem-platform/assets/css/styles.197c61c4.css">
<link rel="preload" href="/ecosystem-platform/assets/js/runtime~main.5c27fe40.js" as="script">
<link rel="preload" href="/ecosystem-platform/assets/js/main.b368de5a.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ecosystem-platform/"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Firefox Ecosystem Platform</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mozilla/ecosystem-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/ecosystem-platform/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON">Platform</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Firefox Accounts</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Firefox Push</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Firefox Sync</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Subscription Platform</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">For FxA Engineers</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-dev-process">Development Process</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-work-breakdown-process">Work Breakdown Process</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ecosystem-platform/fxa-engineering/release-process">Release Process</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-incident-response">Incident Response</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-api">Internal API Documentation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-system-diagrams">FxA System Diagrams</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-logging">Application Logging</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/automation-test-plan">Automation Test Plan</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/vscode-development">Using VS Code with FxA</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-sub-platform">Subscription Platform</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Topic Deep Dives</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-adr">Architectural Decision Records</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-scheduled-maintenance">Scheduled Maintenance</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/fxa-engineering/fxa-additional-docs">Additional Docs</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Release Process</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="release-owner"></a>Release Owner<a class="hash-link" href="#release-owner" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="what-is-a-release-owner"></a>What is a Release Owner?<a class="hash-link" href="#what-is-a-release-owner" title="Direct link to heading">#</a></h3><p>The main purpose of the release owner is to follow the &quot;Releasing Code&quot; process below.  The release owner should work with the rest of the team to ensure a smooth close-out of the current sprint.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="how-is-a-release-owner-selected"></a>How is a Release Owner selected?<a class="hash-link" href="#how-is-a-release-owner-selected" title="Direct link to heading">#</a></h3><p> At the time of writing, the release responsibility is rotated every train to the next team member on the list at the top of our <a href="https://docs.google.com/document/d/1lc5T1ZvQZlhXY6j1l_VMeQT9rs1mN7yYIcHbRPR2IbQ/edit" target="_blank" rel="noopener noreferrer">deployment doc</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="i-am-the-release-owner-how-should-i-plan-my-sprint"></a>I am the Release Owner: How should I plan my Sprint?<a class="hash-link" href="#i-am-the-release-owner-how-should-i-plan-my-sprint" title="Direct link to heading">#</a></h3><p>If you are the designated Release owner, consider the following suggestions to managing your work and the release:</p><ul><li>When taking on work for the sprint, allocate a portion of each day to release management duties - particular as the end of the sprint nears.</li><li>Take some time a day or two before tagging is scheduled to reach out to individual team members to check-in on in-progress or to-do work items. This might result in you taking on additional work performing reviews or reaching out to the appropriate people.<ul><li>Things to consider asking:<ul><li>Are there any tasks that need to be in the train? Are any of them in jeopardy?</li><li>Is there anything I can do to help keep things moving?</li></ul></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="releasing-code"></a>Releasing Code<a class="hash-link" href="#releasing-code" title="Direct link to heading">#</a></h2><ol><li><p>Release ownership is confirmed during the sprint kick-off team meeting.</p></li><li><p>The pre-flight checklist:</p><ol><li>Ensure there are no critical patches for this tag that haven&#x27;t landed yet</li><li>Ensure any previous point releases have been merged back into <code>main</code></li><li>Update the section in the <a href="https://docs.google.com/document/d/1lc5T1ZvQZlhXY6j1l_VMeQT9rs1mN7yYIcHbRPR2IbQ/edit" target="_blank" rel="noopener noreferrer">deployment doc</a> for the Train you are tagging</li><li>Ensure you have appropriate QA signoffs<ul><li>Not applicable for <code>main</code> -&gt; <code>stage</code></li></ul></li><li>Ensure you don&#x27;t have any modified files or code laying around before you start the tag</li><li>Ensure you have the latest from <code>main</code>, including tags. If <code>git fetch [remote]</code> doesn&#x27;t reflect the latest tag, run <code>git fetch [remote] --tags</code>.</li></ol></li></ol><p><strong>The release script expects the git origin to be unchanged from the default.</strong>  If you&#x27;ve modified your git remotes you will get confusing output here and might mess things up.  If in doubt, check out a new copy of FxA (eg. <code>git clone git@github.com:mozilla/fxa.git fxa.tagging</code> and do all your tagging there.</p><p><strong>If you&#x27;re tagging in a newly cloned repo, ensure your commits will be GPG signed.</strong> Run <code>git config --list</code> and verify you see <code>commit.gpgsign=true</code>. If this is not already set globally, run <code>git config --global commit.gpgsign true</code>.</p><ol><li><p>Run <a href="https://github.com/mozilla/fxa/blob/main/release.sh" target="_blank" rel="noopener noreferrer">release.sh</a> from the root of the repository.  Make sure there are no errors in the output.</p></li><li><p>Do some manual checks in the new train branch to make sure the generated tags are sane:</p><ol><li>Do the changelogs match expectations from <code>git log</code>?</li><li>Have all the version strings been updated?</li><li>Does the diff from <code>origin/main</code> (or <code>origin/train-xxx</code> if it’s a point release) look correct?</li></ol></li><li><p>The release script will print some commands to run to push the train branch to the server.  <strong>It&#x27;s best to copy and paste these so you don&#x27;t mix them up.</strong></p></li><li><p>The release script will also print a URL which you can use to open a PR to merge the train branch back into the main branch</p></li><li><p>Finally, the release script will print out a bug template.  Copy that template and open a deployment bug in bugzilla under <code>Cloud Services :: Operations: Deployment Requests</code> (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1575233" target="_blank" rel="noopener noreferrer">example</a>). Remember to include:</p><ol><li>Notes from the deploy doc, particularly any server side changes that need to happen as part of this deployment.</li><li>Links to the needs:qa label on GitHub.</li><li>Links to the release tag on GitHub.</li><li>Links to pertinent changelogs.</li></ol></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="operations-staff-will-take-it-from-there"></a>Operations staff will take it from there…<a class="hash-link" href="#operations-staff-will-take-it-from-there" title="Direct link to heading">#</a></h4><ol><li><p>Ensure that any configuration changes noted in the deployment bug land in <a href="https://github.com/mozilla-services/cloudops-deployment/tree/master/projects/fxa" target="_blank" rel="noopener noreferrer">cloudops-deployment</a>.</p></li><li><p>Run any outstanding database migrations.  These are applied automatically for <code>dev</code> and <code>stage</code> but are reviewed manually for production since we may need to take care with the changes to avoid slow queries.  The migrations should be included in the <a href="https://docs.google.com/document/d/1lc5T1ZvQZlhXY6j1l_VMeQT9rs1mN7yYIcHbRPR2IbQ/edit" target="_blank" rel="noopener noreferrer">deployment doc</a>.</p></li><li><p>Build fxa-auth, fxa-content, fxa-oauth, fxa-profile, fxa-verifier in stage on Jenkins using git commit from cloudops-deployment PR and docker images referenced in deploy bug</p></li><li><p>Request QA on stage (by posting in the bug)</p><ol><li><p>If major issues are found, a new patch is made and we’re back to step 3, running <code>release.sh patch</code></p><ol><li>This command assumes that the relevant commit has been merged into the appropriate train branch. It bumps the minor rev on the last tag it finds in the tree from HEAD, so also requires that you checkout the appropriate train branch locally.</li></ol></li></ol></li><li><p>Deploy fxa-* to production</p></li><li><p>Initial deployment bug is closed</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="special-cases"></a>Special Cases<a class="hash-link" href="#special-cases" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="releasing-icons"></a>Releasing Icons<a class="hash-link" href="#releasing-icons" title="Direct link to heading">#</a></h4><p>All product icons live in a dedicated <code>assets</code> directory in the fxa repo. This directory is independent of individual packages in the monorepo because it doesn&#x27;t need to be wrapped up in any particular container, and these icons may be used across different servers.</p><p>The <code>assets</code> directory is uploaded manually to the FxA CDN at <a href="https://accounts-static.cdn.mozilla.net" target="_blank" rel="noopener noreferrer">https://accounts-static.cdn.mozilla.net</a> as part of the release process. Subdirectories map directly to paths under the CDN domain: content in <code>assets/foo</code> maps to <a href="https://accounts-static.cdn.mozilla.net/foo" target="_blank" rel="noopener noreferrer">https://accounts-static.cdn.mozilla.net/foo</a>.</p><p>The Stripe product icons live in <code>assets/product-icons</code>.</p><p>It&#x27;s fine to create other subdirectories for new collections of assets as needed.</p><p>The release script for static assets is <code>_scripts/upload_assets_to_cdn.sh</code>. It semi-automates pushing the icons to the CDN, assuming the user has the correct credentials / env vars set in their terminal session.</p><p>Icons and other assets are normally deployed with every release. If icons need to be deployed outside the regular release process, just ask ops to run the upload script.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="faq"></a>FAQ<a class="hash-link" href="#faq" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="what-if-the-merge-messes-up-the-changelog"></a>What if the merge messes up the changelog?<a class="hash-link" href="#what-if-the-merge-messes-up-the-changelog" title="Direct link to heading">#</a></h3><p>After merging but before pushing, you should check the changelog to make sure that the expected versions are listed and they&#x27;re in the right order. If any are missing or the order is wrong, manually edit the changelog so that it makes sense, using the commit summaries from <code>git log --graph --oneline</code> to fill in any blanks as necessary.</p><p>Then <code>git add</code> those changes and squash them into the preceding merge commit using <code>git commit --amend</code>. Now you can push and the merged changelog will make sense.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="what-happens-if-there-are-merge-conflicts-train-xxx--main"></a>What happens if there are merge conflicts (train-xxx =&gt; main)?<a class="hash-link" href="#what-happens-if-there-are-merge-conflicts-train-xxx--main" title="Direct link to heading">#</a></h3><p>Conflicts are most likely from a recently landed issue in <code>main</code>. Typically we create a new branch, resolve conflicts there, and then merge that branch into <code>main</code>.</p><p>Merge conflicts in a <code>train-xxx -&gt; main</code> pull request are most likely the result of a recent patch into <code>main</code> branch. The easiest way to resolve this is to:</p><ol><li>Create a new merge branch branch from <code>train-xxx</code>, such as <code>train-xxx-merge-main</code></li><li>Merge the current <code>origin/main</code> into <code>train-xxx-merge-main</code></li><li>Resolve the conflicts that occur in the merge</li><li>Commit changes and push to origin</li><li>Create a new PR, <code>train-xxx-merge-main -&gt; main</code></li><li>Wait for Circle tests to pass and then merge when ready</li></ol><p>You can then close the <code>train-xxx -&gt; main</code> PR.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="merging-and-branching-strategies"></a>Merging and Branching Strategies<a class="hash-link" href="#merging-and-branching-strategies" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="the-happy-path-a-regular-release"></a>The Happy Path: A regular release<a class="hash-link" href="#the-happy-path-a-regular-release" title="Direct link to heading">#</a></h3><p><img alt="A simplified merging diagram" src="/ecosystem-platform/assets/images/fxa-release1-ccca6cee170e393a55428a6ed229e60f.png"></p><p>During a regular release, running <code>release.sh</code> will create an appropriately named branch, update a few files like the Changelogs, and create a tag.  The Release Owner will push the branch to github and open a pull request back to <code>main</code>.</p><p>An example of commands to run for a release are:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout main</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain">./release.sh</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Follow the instructions printed</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="a-patch-release"></a>A Patch Release<a class="hash-link" href="#a-patch-release" title="Direct link to heading">#</a></h3><p><img alt="A patch release diagram" src="/ecosystem-platform/assets/images/fxa-release4-e1bfc4b0697908160e76be27aa1fdc31.png"></p><p>A patch release is used between official releases.  For example, a regression discovered midway through a sprint that can&#x27;t wait for a normal release cycle would be pushed to production earlier through this process.</p><p>In the scenario above, a regular release happened and <code>v1.100.0</code> was tagged and pushed to production.  Later, to fix a regression, a patch was landed <em>directly on the branch</em> rather than on <code>main</code>.  <code>release.sh patch</code> was run and <code>v1.100.1</code> was tagged.  Four more commits landed on the branch and <code>release.sh patch</code> tagged a <code>v1.100.2</code>.  In this scenario there were two patch releases in addition to the regular release at the end of the sprint.</p><p>An example of commands to run for a patch release are:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout main</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout train-100</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Ensure the pull requests on GitHub have landed before you continue</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> log  </span><span class="token comment" style="color:#999988;font-style:italic"># Verify it looks like you expect</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">./release.sh patch</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Follow the instructions printed</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="another-option-for-a-patch-release"></a>Another Option for a Patch Release<a class="hash-link" href="#another-option-for-a-patch-release" title="Direct link to heading">#</a></h3><p><img alt="A alternative patch release diagram" src="/ecosystem-platform/assets/images/fxa-release5-66268472de4c57e89a3171c4daa222d9.png"></p><p>An alternative to the Patch Release described above would be to use an additional branch.  This would allow you to test complex changes without affecting the current release branch.</p><p>In the scenario above, a regular release occurs.  Then it&#x27;s determined that two patches which landed on main earlier in the cycle are critical to be live now.  They are cherry-picked to an uplift branch, tested, and then merged back to the regular release branch.  At that point <code>release.sh patch</code> will do the regular updates.</p><p>An example of commands to run for this option are:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout main</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout train-100</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> branch train-100-uplift</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout train-100-uplift</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> cherry-pick </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">commit</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> cherry-pick </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">commit</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">repeat as needed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> log  </span><span class="token comment" style="color:#999988;font-style:italic"># Verify you picked what you wanted to</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push origin train-100-uplift</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># On GitHub:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1) make a Pull Request for train-100-uplift to merge into train-100</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2) Ask for review</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3) Wait for CI to pass ✅</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4) Merge the Pull Request</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout train-100</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> pull</span></span><span class="token-line" style="color:#393A34"><span class="token plain">./release.sh patch</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Follow the instructions printed</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Git is a flexible tool and there are other options if other scenarios arise.  Don&#x27;t hesitate to get in touch with your team to talk through the best courses of action.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="a-security-release"></a>A Security Release<a class="hash-link" href="#a-security-release" title="Direct link to heading">#</a></h3><p><img alt="Diagram showing a security release" src="/ecosystem-platform/assets/images/fxa-release3-ca2a4f7e30fc26e811457d5e9e3acad4.png"></p><p>A security release will make use of the <code>fxa-private</code> repository.  This diagram illustates an important security patch being pushed live midway through sprint 100.  Firstly, we need to bring <code>fxa-private</code> up to speed since it probably hasn&#x27;t been used in a while.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone git@github.com:mozilla/fxa-private.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> fxa-private</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> remote </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> fxa https://github.com/mozilla/fxa.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> fetch fxa --tags</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> merge v0.100.0   </span><span class="token comment" style="color:#999988;font-style:italic"># Replace this with whatever tag is currently live</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Next, make a patch for whatever needs fixing and pull request against <code>fxa-private</code>.  The patch is reviewed as normal and lands on <code>fxa-private</code>.</p><p>Operations is involved at this point to deploy to production directly from <code>fxa-private</code> so the patch is never seen before it&#x27;s live.</p><p>Once the fix is verified in production, the patch is cherry-picked or merged back to <code>fxa</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="temporary-stage-deploys"></a>Temporary stage deploys<a class="hash-link" href="#temporary-stage-deploys" title="Direct link to heading">#</a></h2><p>If you are working on something that you wish to test out in a release environment before it is officially merged into <code>main</code> you might consider a temporary deploy to stage.</p><p>To do so, start by branching off the most recent train branch. Don&#x27;t branch off <code>main</code> so you&#x27;re not introducing changes merged after the official train was deployed.</p><p>Commit your changes, tag them, and push. Because you&#x27;re pushing a tag it will trigger a build workflow in CircleCI. Keep an eye on the <code>deploy-packages</code> job.</p><p>Once the images have been built you can ping someone from Ops in Slack to selectively deploy servers your changes occurred in (e.g. if you only change code in <code>fxa-auth-server</code>, only the auth server needs to be deployed).</p><p>Some things to keep in mind:</p><ul><li>This is a temporary deploy. Your changes will be reverted when the next official stage train tag occurs, or if someone else needs to perform this process.</li><li>We have relying parties that depend on stage for their own testing, so try not to break things with your temporary code. If you think this is a possibility please consider pinging QA in Slack so they can perform tests as needed.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/ecosystem-platform/edit/main/website/docs/fxa-engineering/release-process.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ecosystem-platform/fxa-engineering/fxa-work-breakdown-process"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Work Breakdown Process</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ecosystem-platform/fxa-engineering/fxa-incident-response"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Incident Response »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#release-owner" class="table-of-contents__link">Release Owner</a><ul><li><a href="#what-is-a-release-owner" class="table-of-contents__link">What is a Release Owner?</a></li><li><a href="#how-is-a-release-owner-selected" class="table-of-contents__link">How is a Release Owner selected?</a></li><li><a href="#i-am-the-release-owner-how-should-i-plan-my-sprint" class="table-of-contents__link">I am the Release Owner: How should I plan my Sprint?</a></li></ul></li><li><a href="#releasing-code" class="table-of-contents__link">Releasing Code</a><ul><li><a href="#special-cases" class="table-of-contents__link">Special Cases</a></li></ul></li><li><a href="#faq" class="table-of-contents__link">FAQ</a><ul><li><a href="#what-if-the-merge-messes-up-the-changelog" class="table-of-contents__link">What if the merge messes up the changelog?</a></li><li><a href="#what-happens-if-there-are-merge-conflicts-train-xxx--main" class="table-of-contents__link">What happens if there are merge conflicts (train-xxx =&gt; main)?</a></li></ul></li><li><a href="#merging-and-branching-strategies" class="table-of-contents__link">Merging and Branching Strategies</a><ul><li><a href="#the-happy-path-a-regular-release" class="table-of-contents__link">The Happy Path: A regular release</a></li><li><a href="#a-patch-release" class="table-of-contents__link">A Patch Release</a></li><li><a href="#another-option-for-a-patch-release" class="table-of-contents__link">Another Option for a Patch Release</a></li><li><a href="#a-security-release" class="table-of-contents__link">A Security Release</a></li></ul></li><li><a href="#temporary-stage-deploys" class="table-of-contents__link">Temporary stage deploys</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Mozilla Corporation.</div></div></div></footer></div>
<script src="/ecosystem-platform/assets/js/runtime~main.5c27fe40.js"></script>
<script src="/ecosystem-platform/assets/js/main.b368de5a.js"></script>
</body>
</html>