<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/token-types">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Types of Auth Tokens | Firefox Ecosystem Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mozilla.github.io/ecosystem-platform/reference/token-types"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Types of Auth Tokens | Firefox Ecosystem Platform"><meta data-rh="true" name="description" content="Last updated: December 04th, 2019"><meta data-rh="true" property="og:description" content="Last updated: December 04th, 2019"><link data-rh="true" rel="icon" href="/ecosystem-platform/img/firefox-logo.png"><link data-rh="true" rel="canonical" href="https://mozilla.github.io/ecosystem-platform/reference/token-types"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/reference/token-types" hreflang="en"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/reference/token-types" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RFM5H13DFK-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Firefox Ecosystem Platform" href="/ecosystem-platform/opensearch.xml"><link rel="stylesheet" href="/ecosystem-platform/assets/css/styles.cc148c19.css">
<link rel="preload" href="/ecosystem-platform/assets/js/runtime~main.094a1df4.js" as="script">
<link rel="preload" href="/ecosystem-platform/assets/js/main.9bf380a0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ecosystem-platform/"><div class="navbar__logo"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Firefox Ecosystem Platform</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mozilla/ecosystem-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ecosystem-platform/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Relying Parties</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/tutorials/integration-with-fxa">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/how-twos/end-to-end-encryption">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/reference/metrics-for-relying-parties">Reference</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">For FxA Engineers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/tutorials/development-setup">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/how-tos/creating-an-account-locally">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/ecosystem-platform/reference/team-processes/development-process">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/team-processes/development-process">Team Processes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/style-guides/general-best-practices">Style Guides</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/browser-support">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/incident-response">Incident Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/emails">Emails</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/localization">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ecosystem-platform/reference/token-types">Types of Auth Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/jwt-access-tokens">JWT Access Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/storybook-deploys-with-circleci">Storybook Deploys with CircleCI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/webchannels-in-firefox-desktop-fennec">WebChannels in Firefox Desktop &amp; Fennec</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/webchannels-in-fenix-webextensions">WebChannels in Fenix &amp; WebExtensions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/tests-in-circleci">Tests in CircleCI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/functional-testing">Functional Tests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/automation-testplan">Automation Test Plan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/internal-api-documentation">Internal API Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/experiments-ab-testing">Experiments &amp; A/B Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/system-diagrams">System Diagrams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/application-logging">Application Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/application-tracing">Application Tracing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/scheduled-maintenance">Scheduled Maintenance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/mobile-specifics">Mobile Specifics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/architectural-decision-records">Architectural Decision Records</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/github-strategies">GitHub Strategies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/third-party-authentication">Third Party Authentication in FxA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/rate-limiting">Rate limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/using-swagger-for-api-documentation">Using Swagger for API documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href="https://docs.telemetry.mozilla.org/datasets/fxa.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Telemetry Data Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/explanation/metrics">Explanation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/additional-docs">Additional Docs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Support Agents</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/admin-panel">Reference</a></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ecosystem-platform/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">For FxA Engineers</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Types of Auth Tokens</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Types of Auth Tokens</h1></header><p>Last updated: <code>December 04th, 2019</code></p><p>Firefox Accounts uses a number of different types of &quot;token&quot; to keep track of whether a user has been authenticated,
and of what actions a client is authorized to perform. This document provides an overview of the different types of
token, their properties and intended uses.</p><p>The most important types of token for FxA Replying Parties to know about are:</p><ul><li><a href="#session-tokens">Session Tokens</a>, long-lived tokens that represent an authenticated user session with the FxA servers.</li><li><a href="#oauth-refresh-tokens">OAuth Refresh Tokens</a>, long-lived tokens indicating that the user has authorized a particular client to perform
particular actions on their behalf.</li><li><a href="#oauth-access-tokens">OAuth Access Tokens</a>, short-lived tokens used by authorized clients when performing particular actions
on behalf of the user.</li><li><a href="#oidc-identity-tokens">OIDC Identity Tokens</a>, short-lived JWTs used to communicate an authentication event from FxA
to a relying party.</li></ul><p>FxA has additional types of token that it uses for its own account-management purposes, but which should
never be visible to Relying Parties:</p><ul><li><a href="#keyfetch-tokens">KeyFetch Tokens</a></li><li><a href="#password-change-tokens">Password Change Tokens</a></li><li><a href="#password-forgot-tokens">Password Forgot Tokens</a></li><li><a href="#account-reset-tokens">Account Reset Tokens</a></li></ul><p>Relying Parties that wish to integrate with Firefox Sync may also need to know about these additional types
of token:</p><ul><li><a href="#browserid-assertions">BrowserID Assertions</a></li><li><a href="#sync-storage-credentials">Sync Storage Credentials</a></li></ul><h1>Token Usage Mechanisms</h1><p>A <strong><em>Bearer Token</em></strong> is an opaque string that can be used by any client in posession of the token, simply by presenting
it verbatim in the request to the server (e.g. in the <code>Authorization</code> header). These are the simplest types of token
for clients to use, but allow for interception and replay attacks. In particular, the server that receives a Bearer Token
is capable of extracting it and using it to perform other API calls.</p><p>A <strong><em>Hawk Token</em></strong> consists of an opaque string id and corresponding secret key. To use the token, clients must use the
secret key to sign outgoing requests using <a href="https://github.com/mozilla/hawk/blob/main/API.md" target="_blank" rel="noopener noreferrer">the scheme described here</a>. This is more
complicated for clients but it binds the use of the token to the particular request being made, and it offers the
potential for replay prevention.</p><p>An <strong><em>FxA Hawk Token</em></strong> is a 32-byte string from which the id and key of a <strong><em>Hawk Token</em></strong> can be generated using HKDF.
This simplifies client handling of the token since it only has to persist a single value.</p><h1>Session Tokens</h1><p>A <code>sessionToken</code> is the Firefox Accounts equivalent of traditional website login session cookie - it represents
the user who is currently signed in to accounts.firefox.com, and it used to authenticate many calls from the
FxA front-end website to the FxA back-end API.</p><p>Session tokens are an <strong><em>FxA Hawk Token</em></strong> where the 32-byte string is generated by the server. They can be obtained by:</p><ul><li>The successful creation of a new account, via the <code>/account/create</code> endpoint.</li><li>A successful login to a new account, via the <code>/account/login</code> endpoint.</li><li>Duplicating an existing <code>sessionToken</code>, via the <code>/session/duplicate</code> endpoint.</li><li>Providing the id of a previous <code>sessionToken</code> when changing the account password, via the <code>/password/change/finish</code>
endpoint.</li><li>Requesting the <code>https://identity.mozilla.com/tokens/session</code> scope during an OAuth flow.</li></ul><p>Session tokens are intended only for authenticated communication with the FxA servers themselves, so RP servers
should never encounter a session token in the wild.</p><p>On the client side, session tokens are typically handled by web content on accounts.firefox.com while the user
is interacting with their account. However, web browsers that support signing in with FxA in order to access
account-enabled browser features, may obtain a session token during the sigin flow and use it to communicate
directly with the FxA server APIs.</p><h1>Session Metadata</h1><p>Since session tokens represent a signed-in user, the server maintains a lot of additional metadata about the user&#x27;s
signed-in state. Properties of the session token include:</p><ul><li>The types of authentication performed by the user, and level of confidence in their identity.</li><li>Timestamp at which authentication last occurred (which can be increased by prompting the user to re-enter their
password).</li><li>Timestamp at which the token was last used (truncated to a few hours granularity to reduce db write load).</li><li>Details of the user-agent string from the last use of the token.</li><li>The geolocation of the IP address that requested the session token</li></ul><p>This information may be used by the FxA server to make authorization decisions, and RPs may request that a user
be authenticated to a certain level of assurance (such as requiring that the sessionToken be last-authenticated
within a certain amount of time, or authenticated via 2FA).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="verified-sessions">Verified Sessions<a class="hash-link" href="#verified-sessions" title="Direct link to heading">​</a></h2><p>As an additional security measure against <a href="https://blog.mozilla.org/services/2016/04/09/stolen-passwords-used-to-break-into-firefox-accounts/" target="_blank" rel="noopener noreferrer">credential-stuffing
attacks</a>,
FxA has the notion of a &quot;verified session&quot;, which is intended to indicate a higher level of confidence in the
authenticity of the user.</p><p>A session is considered verified if the user did some additional authentication step <em>in addition</em> to proving
knowledge of the account password, such as completing an email confirmation loop or answering a 2FA challenge.
Sessions may also be considered verified based on server-side heuristics, such as whether the account is newly-created
or whether we&#x27;ve seen previous verified logins form the same IP address.</p><p>Certain actions on the account can only be performed with a verified session, including:</p><ul><li>Modifying email or 2FA settings</li><li>Authorizing OAuth grants that involve key-bearing scopes</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-factor-auth">Multi-Factor Auth<a class="hash-link" href="#multi-factor-auth" title="Direct link to heading">​</a></h2><p>If the user enables two-step authentication on their account, then each sessionToken will keep track of
whether it has been involved in a successful 2FA authentication. This information is reported in the session
metadata in two ways:</p><ul><li>The &quot;authenticator assurance level&quot; or &quot;AAL&quot; is a numeric indicator of the number of distinct types of
authentication factor that have been provided for a session; it will be <code>2</code> for sessions in which the user
has successfully successfully performed 2FA.</li><li>The &quot;authentication methods&quot; is a list of all the different types of authentication action that have been
performed on this session (such as &quot;entered password&quot; or &quot;completed email loop&quot; or &quot;provided totp code&quot;).
It&#x27;s a more detailed view than the summary provided by the AAL.</li></ul><h1>OAuth Refresh Tokens</h1><p>RPs that wish to obtain long-lived permission to access the user&#x27;s account data should request
an <a href="https://oauth.net/2/grant-types/refresh-token/" target="_blank" rel="noopener noreferrer">OAuth Refresh Token</a> as part of their authorization flow.
This is a long-lived <strong><em>Bearer Token</em></strong> that represents the permissions granted by the user to that RP.
For example the refresh token might indicate that the RP has permission to read the user&#x27;s profile data.</p><p>Refresh tokens can only be created by authorizing them via a valid <code>sessionToken</code>.</p><p>Refresh tokens should only ever be presented to the FxA auth/oauth server, and should <strong>not</strong> be used when
talking to other resource servers. Instead, the RP should use the refresh token to generate a short-lived
<!-- -->[access token][#oauth-access-tokens]<!-- --> and use that to communicate with resource servers.</p><h1>OAuth Access Tokens</h1><p>RPs that wish to access resource servers on behalf of the user (say, to read or store user data) need
to obtain an <a href="https://www.oauth.com/oauth2-servers/access-tokens/" target="_blank" rel="noopener noreferrer">OAuth Access Token</a>.  This is a short-lived
<strong><em>Bearer Token</em></strong> that represents the permissions granted by the user to that RP, in a format that can
be consumed by resource servers. For example the RP might use an access token with scope &quot;profile&quot; in order
to read the user&#x27;s profile data from the FxA profile server.</p><p>FxA also supports JWT Access tokens.  See <a href="/ecosystem-platform/reference/jwt-access-tokens">JWT Access Tokens</a> for an in-depth look at that less-commonly-used type.</p><h1>OIDC Identity Tokens</h1><p>They&#x27;re for signin.</p><p>See the <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken" target="_blank" rel="noopener noreferrer">OIDC spec</a> and the
<a href="https://accounts.firefox.com/.well-known/openid-configuration" target="_blank" rel="noopener noreferrer">FxA supported claims</a>.</p><p>This token, a JWT, proves that a user&#x27;s been authenticated (in this case,
with FxA). It can also be used as the <code>id_token_hint</code> query param value in a
<code>prompt=none</code> flow (<a href="https://github.com/mozilla/fxa/blob/main/packages/fxa-auth-server/docs/oauth/prompt-none.md" target="_blank" rel="noopener noreferrer">additional information</a>]).</p><p>This token is issued along with the access token and refresh token when the
scope &quot;openid&quot; is present.</p><h1>KeyFetch Tokens</h1><p>They&#x27;re for fetching keys. RPs shouldn&#x27;t need to now this, because they use the scoped-keys flow.</p><h1>Password Change Tokens</h1><p>Special-use token for changing password. Hawk token.</p><h1>Password Forgot Tokens</h1><p>Special-use token for resetting password. Needs to be verified via a code received over email.
Limited number of verification attempts. Generates a reset token.</p><h1>Account Reset Tokens</h1><p>Special-use token for resetting the password.</p><h1>BrowserID Assertions</h1><p>Legacy identity assertion format. Used by sync, and accepted when granting OAuth tokens, but
should not be used for anything new.</p><p>BrowserID stopped being used in Firefox 80 and we&#x27;re eagerly awaiting the long
tail of users to upgrade so we can remove this code.  See details in
<a href="https://github.com/mozilla/fxa/issues/9007" target="_blank" rel="noopener noreferrer">Issue #9007 / FXA-2715</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/ecosystem-platform/edit/master/docs/reference/token-types.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/ecosystem-platform/reference/metrics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Metrics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ecosystem-platform/reference/jwt-access-tokens"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JWT Access Tokens</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#verified-sessions" class="table-of-contents__link toc-highlight">Verified Sessions</a></li><li><a href="#multi-factor-auth" class="table-of-contents__link toc-highlight">Multi-Factor Auth</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Mozilla Corporation.</div></div></div></footer></div>
<script src="/ecosystem-platform/assets/js/runtime~main.094a1df4.js"></script>
<script src="/ecosystem-platform/assets/js/main.9bf380a0.js"></script>
</body>
</html>